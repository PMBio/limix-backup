sudo: required
services: docker
language: python
python:
- 2.7
env:
- IMG_BASE=science-conda2
- IMG_BASE=science-canopy2
- IMG_BASE=science-bare
addons:
  apt:
    packages:
    - build-essential
    - libc6
    - g++
    - gfortran
before_install:
- docker pull dhorta/$IMG_BASE
script:
- ./docker-test.sh $IMG_BASE
before_deploy:
- sudo apt-get update -qq
- sudo apt-get install --yes build-essential libc6 gfortran g++
- sudo apt-get install --yes python python-setuptools cython python-numpy
- sudo apt-get install --yes python-scipy python-matplotlib pkg-config
- sudo apt-get install --yes libfreetype6-dev libpng12-dev libhdf5-dev
- sudo apt-get install --yes liblapack-dev
deploy:
  provider: pypi
  user: horta
  password:
    secure: IpOuXyK6lWPwT0jsbKGfU62EyLhitlzIoVle9O8bVxjUej6OgqmkUZavbJttQLtG/C0/zKtxaD7qW8S9dKwCKXVkdR/yabBMBaeMT61LO6/Q2EN0kNbXTYKlde+bhWv25osAIWCvfss5ip7cvPE8h0s8M3HHKbvBnFIhxNgT0atV+tcmP+IkBt+n5DMCoNZJRcfX3830qT5qon3Ha2T6PnDBvCDPtZEaG7HHLm8h5siZM2dV4Qffw7Gf/FcLur0s0HUCdi6/Jh/jzJzliQstAdJLRwiNcpcPLtYQUmXgOB0Ri82Oe4fDOizZ+gt4Vp3Ex2kOqmXkcxHOs9OYRb2h2uzUoXhgZLwcfEpGzMy7Vve8AMXWAg2y2L1y3dqoMa/cJXNdHvqNlKyOmZhHLPHh3p6XPCjgamJ5V8QNZwi/UBY22srxNd4lVpRfGUfdinwBU4RggBteNiTM5NUNNIIRmVf5iVbneH7Vmsxl3IAJYqn4heiS91NAw/oWcD87rtXTIJzmvHHMQz5hF4CObJMrc27CjDeGwwD4ptKn518DJNanLt/JbUnhSLmvGemz8sRFrYRtHf178K+JDOfGFihjqV1UmR1UzvtAXCgdMmkDAZXxvo110fsf0v229Qm9NXO2KxgBrmTKKbNtqGGPUT1iFMK6pBgRFYQo5C63FA5KWKc=
  on:
    branch: master
    tags: true
    distributions: sdist
    repo: PMBio/limix
